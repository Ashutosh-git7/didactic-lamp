<!DOCTYPE html>
<html>
<head>
  <title>Ashirwad 2X App</title>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <style>
    body { font-family: Arial; margin: 0; background: #f0f0f0; color: #333; }
    header { background: #4CAF50; color: white; padding: 15px; text-align: center; }
    section, .card { padding: 15px; margin: 10px; background: white; border-radius: 10px; box-shadow: 0 0 5px rgba(0,0,0,0.1);}
    input, button { padding: 10px; margin: 5px 0; width: 100%; box-sizing: border-box; border: 1px solid #ccc; border-radius: 8px;}
    button { background: #4CAF50; color: white; font-weight: bold; border: none; cursor: pointer; }
    .hide { display: none; }
    textarea { width: 100%; height: 300px; }
    nav { text-align: center; padding: 10px; background: #eee; }
  </style>
</head>
<body>

<header>
  <h2>Ashirwad 2X Income App</h2>
</header>

<!-- Login / Registration Section -->
<section id="loginSection">
  <h3>Register / Login</h3>
  <input id="userId" placeholder="Enter ID (start with ANS)" />
  <input id="wallet" placeholder="Enter BEP20 Wallet Address" />
  <input id="refCode" placeholder="Referral Code (optional)" />
  <button onclick="loginUser()">Login / Register</button>
  <p id="loginMsg"></p>
</section>

<!-- User Dashboard -->
<section id="userPanel" class="hide">
  <h3>Welcome: <span id="currentId"></span></h3>
  <div class="card">
    <p><b>Wallet:</b> <span id="showWallet"></span></p>
    <p><b>Total Deposit:</b> <span id="showDeposit">0</span> USDT</p>
    <p><b>Total Paid:</b> <span id="showPaid">0</span> USDT</p>
    <p><b>Referral Bonus:</b> <span id="showReferral">0</span> USDT</p>
    <p><b>Agreement Status:</b> <span id="showAgreement">open</span></p>
  </div>

  <div class="card">
    <h4>Make a Deposit (50–500 USDT)</h4>
    <p>Send USDT (BEP20) to:</p>
    <p><b>0x49F7A836A32C1aCF04d4d20Fa87A14C7a19aB74B</b></p>
    <input id="depositAmt" placeholder="Enter amount (50–500)" />
    <button onclick="makeDeposit()">Submit Deposit</button>
  </div>

  <div class="card">
    <h4>Withdraw Income</h4>
    <button onclick="withdrawIncome()">Withdraw Referral / Profit</button>
  </div>

  <div class="card">
    <h4>Your Referral Link</h4>
    <input id="refLink" readonly />
  </div>
</section>

<!-- Admin Login Section -->
<section id="adminLoginSection">
  <h3>Admin Login</h3>
  <input id="adminId" placeholder="Admin ID" />
  <input id="adminPass" type="password" placeholder="Admin Password" />
  <button onclick="adminLogin()">Login as Admin</button>
</section>

<!-- Admin Panel -->
<section id="adminPanel" class="hide">
  <h3>Admin Panel</h3>
  <textarea id="adminEditor"></textarea>
  <button onclick="saveAdminData()">Save Changes</button>
</section>

<nav>
  <small>&copy; 2025 Ashirwad Mart</small>
</nav>

<script>
let db = JSON.parse(localStorage.getItem("ashirwadData") || "{}");
let current = "";

// Save DB
function saveDB() {
  localStorage.setItem("ashirwadData", JSON.stringify(db));
}

// Register/Login User
function loginUser() {
  const id = document.getElementById("userId").value.trim().toUpperCase();
  const wallet = document.getElementById("wallet").value.trim();
  const ref = document.getElementById("refCode").value.trim().toUpperCase();

  if (!id.startsWith("ANS")) {
    document.getElementById("loginMsg").innerText = "ID must start with ANS";
    return;
  }
  if (!wallet.startsWith("0x") || wallet.length < 20) {
    document.getElementById("loginMsg").innerText = "Invalid wallet address";
    return;
  }

  if (!db[id]) {
    db[id] = { wallet, deposit: 0, paid: 0, referral: 0, agreement: "open", ref: ref || "" };
    if (ref && db[ref]) {
      db[ref].referral += 5; // 5% as USDT
    }
  }

  current = id;
  saveDB();
  showUserPanel();
}

// Display User Info
function showUserPanel() {
  document.getElementById("loginSection").classList.add("hide");
  document.getElementById("userPanel").classList.remove("hide");

  const user = db[current];
  document.getElementById("currentId").innerText = current;
  document.getElementById("showWallet").innerText = user.wallet;
  document.getElementById("showDeposit").innerText = user.deposit;
  document.getElementById("showPaid").innerText = user.paid;
  document.getElementById("showReferral").innerText = user.referral;
  document.getElementById("showAgreement").innerText = user.agreement;
  document.getElementById("refLink").value = location.href.split("?")[0] + "?r=" + current.toLowerCase();
}

// Deposit Function
function makeDeposit() {
  const amt = parseFloat(document.getElementById("depositAmt").value);
  if (amt < 50 || amt > 500) return alert("Amount must be between 50–500");
  db[current].deposit += amt;
  saveDB();
  alert("Deposit recorded. Admin approval required.");
  showUserPanel();
}

// Withdraw Function
function withdrawIncome() {
  const user = db[current];
  const total = user.referral + user.paid;
  if (total < 1) return alert("Minimum 1 USDT required to withdraw.");
  alert("Withdrawal submitted.");
  db[current].referral = 0;
  saveDB();
  showUserPanel();
}

// Admin Login
function adminLogin() {
  const id = document.getElementById("adminId").value.trim();
  const pass = document.getElementById("adminPass").value.trim();
  if (id === "Admin" && pass === "Jaihanuman@7") {
    document.getElementById("adminPanel").classList.remove("hide");
    document.getElementById("adminEditor").value = JSON.stringify(db, null, 2);
  } else {
    alert("Invalid admin credentials.");
  }
}

// Admin Save Changes
function saveAdminData() {
  try {
    db = JSON.parse(document.getElementById("adminEditor").value);
    saveDB();
    alert("Database updated successfully.");
  } catch (e) {
    alert("Invalid data.");
  }
}

// Pre-fill referral from link
window.onload = () => {
  const url = new URLSearchParams(window.location.search);
  const r = url.get("r");
  if (r) document.getElementById("refCode").value = r;
}
</script>

</body>
</html>
