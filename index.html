<!DOCTYPE html>
<html>
<head>
  <title>Ashirwad Mart App</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 10px; background: #f4f4f4; }
    .container { max-width: 500px; margin: auto; background: white; padding: 20px; border-radius: 10px; }
    h2 { text-align: center; }
    input, select, button { width: 100%; padding: 10px; margin: 10px 0; border-radius: 5px; border: 1px solid #ccc; }
    .hidden { display: none; }
    .btn { background: #007bff; color: white; border: none; cursor: pointer; }
    .btn:hover { background: #0056b3; }
    .section { margin-bottom: 20px; }
    .admin-only { background: #eee; padding: 10px; margin: 5px 0; }
  </style>
</head>
<body>
  <div class="container">
    <h2 id="appTitle">Ashirwad Mart App</h2>

    <!-- Login/Register -->
    <div id="authSection">
      <input id="refInput" placeholder="Referral ID (optional)">
      <input id="userId" placeholder="User ID (start with ASH)">
      <input id="password" type="password" placeholder="Password">
      <input id="wallet" placeholder="USDT BEP20 Wallet Address">
      <button onclick="register()">Register</button>
      <hr>
      <input id="loginUserId" placeholder="User ID">
      <input id="loginPassword" type="password" placeholder="Password">
      <button onclick="login()">Login</button>
      <p><b>Admin ID:</b> Admin<br><b>Password:</b> Jaihanuman@7</p>
    </div>

    <!-- User Dashboard -->
    <div id="userDashboard" class="hidden">
      <h3>Welcome, <span id="userName"></span></h3>
      <p><b>Your Wallet:</b> <span id="userWallet"></span></p>
      <p><b>Your Referral ID:</b> <span id="refId"></span></p>
      <p><b>Referral Commission:</b> <span id="refComm">0</span> USDT</p>
      <p><b>Total Deposited:</b> <span id="userDeposit">0</span> USDT</p>
      <p><b>Profit Received:</b> <span id="userProfit">0</span> USDT</p>
      <p><b>Withdrawable:</b> <span id="userWithdraw">0</span> USDT</p>

      <div class="section">
        <h4>Deposit</h4>
        <p>Send USDT BEP20 to:<br><b>0x49F7A836A32C1aCF04d4d20Fa87A14C7a19aB74B</b></p>
        <input id="depositAmt" type="number" placeholder="Amount (50â€“500 USDT)">
        <button onclick="submitDeposit()">Submit Deposit</button>
      </div>

      <div class="section">
        <button onclick="withdraw()">Withdraw</button>
      </div>

      <button onclick="logout()">Logout</button>
    </div>

    <!-- Admin Panel -->
    <div id="adminPanel" class="hidden">
      <h3>Admin Panel</h3>
      <div id="adminUsers"></div>
      <button onclick="logout()">Logout</button>
    </div>
  </div>

  <script>
    let users = JSON.parse(localStorage.getItem("users") || "{}");
    let currentUser = null;

    function saveUsers() {
      localStorage.setItem("users", JSON.stringify(users));
    }

    function register() {
      const id = document.getElementById("userId").value.trim();
      const pw = document.getElementById("password").value;
      const wallet = document.getElementById("wallet").value.trim();
      const ref = document.getElementById("refInput").value.trim();

      if (!id.startsWith("ASH")) return alert("User ID must start with 'ASH'");
      if (users[id]) return alert("User ID already exists");
      if (!wallet) return alert("Wallet address is required");

      users[id] = {
        password: pw,
        wallet: wallet,
        ref: ref || null,
        deposit: 0,
        profit: 0,
        withdrawable: 0,
        refEarned: 0
      };

      if (ref && users[ref]) {
        users[ref].refEarned = (users[ref].refEarned || 0) + 0;
      }

      saveUsers();
      alert("Registered successfully!");
    }

    function login() {
      const id = document.getElementById("loginUserId").value.trim();
      const pw = document.getElementById("loginPassword").value;

      if (id === "Admin" && pw === "Jaihanuman@7") {
        showAdmin();
        return;
      }

      const user = users[id];
      if (!user || user.password !== pw) return alert("Invalid credentials");

      currentUser = id;
      showUserDashboard();
    }

    function showUserDashboard() {
      const u = users[currentUser];
      document.getElementById("authSection").classList.add("hidden");
      document.getElementById("userDashboard").classList.remove("hidden");
      document.getElementById("userName").innerText = currentUser;
      document.getElementById("userWallet").innerText = u.wallet;
      document.getElementById("refId").innerText = currentUser;
      document.getElementById("refComm").innerText = u.refEarned || 0;
      document.getElementById("userDeposit").innerText = u.deposit || 0;
      document.getElementById("userProfit").innerText = u.profit || 0;
      document.getElementById("userWithdraw").innerText = u.withdrawable || 0;
    }

    function submitDeposit() {
      const amt = parseFloat(document.getElementById("depositAmt").value);
      if (amt < 50 || amt > 500) return alert("Amount must be between 50 and 500");

      const u = users[currentUser];
      if (u.deposit > 0) return alert("You already deposited");

      u.deposit = amt;
      u.profit = 0;
      u.withdrawable = 0;

      if (u.ref && users[u.ref]) {
        users[u.ref].refEarned += amt * 0.05;
        users[u.ref].withdrawable += amt * 0.05;
      }

      saveUsers();
      alert("Deposit recorded. Wait for admin approval.");
      showUserDashboard();
    }

    function withdraw() {
      const u = users[currentUser];
      if (u.withdrawable < 1) return alert("Minimum $1 required to withdraw");
      alert(`Withdraw request of $${u.withdrawable} sent.`);
      u.withdrawable = 0;
      saveUsers();
      showUserDashboard();
    }

    function logout() {
      currentUser = null;
      document.getElementById("authSection").classList.remove("hidden");
      document.getElementById("userDashboard").classList.add("hidden");
      document.getElementById("adminPanel").classList.add("hidden");
    }

    function showAdmin() {
      document.getElementById("authSection").classList.add("hidden");
      document.getElementById("adminPanel").classList.remove("hidden");

      let html = "";
      Object.keys(users).forEach(id => {
        const u = users[id];
        html += `<div class="admin-only">
          <b>${id}</b><br>
          Wallet: ${u.wallet}<br>
          Deposit: ${u.deposit} | Profit: ${u.profit}<br>
          Withdrawable: ${u.withdrawable}<br>
          <button onclick="approveProfit('${id}')">+10% Weekly</button>
          <button onclick="closeAgreement('${id}')">Close 2x</button>
          <button onclick="resetUser('${id}')">Reset</button>
        </div>`;
      });
      document.getElementById("adminUsers").innerHTML = html;
    }

    function approveProfit(id) {
      const u = users[id];
      const maxProfit = u.deposit * 2;
      const add = u.deposit * 0.1;

      if ((u.profit + add) <= maxProfit) {
        u.profit += add;
        u.withdrawable += add;
        alert("Profit added.");
      } else {
        alert("2x limit reached.");
      }

      saveUsers();
      showAdmin();
    }

    function closeAgreement(id) {
      const u = users[id];
      u.profit = u.deposit * 2;
      u.withdrawable = u.deposit * 2;
      alert("Agreement closed.");
      saveUsers();
      showAdmin();
    }

    function resetUser(id) {
      users[id].deposit = 0;
      users[id].profit = 0;
      users[id].withdrawable = 0;
      saveUsers();
      showAdmin();
    }
  </script>
</body>
</html>
