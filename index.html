<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ashirwad Crowdfunding App</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f1f1f1; padding: 20px; }
    .container { max-width: 600px; margin: auto; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px #ccc; }
    input, button, select { width: 100%; padding: 10px; margin-top: 10px; border-radius: 5px; border: 1px solid #ccc; }
    .admin-only { display: none; }
    .highlight { background: #e6ffe6; padding: 10px; border-radius: 5px; }
    .hide { display: none; }
  </style>
</head>
<body>
<div class="container">
  <h2>üåü Ashirwad USDT Plan</h2>

  <div id="auth">
    <input type="text" id="uid" placeholder="User ID (New or Existing)" />
    <input type="text" id="ref" placeholder="Referral ID (Optional)" />
    <button onclick="login()">Login / Register</button>
  </div>

  <div id="app" class="hide">
    <p>Welcome, <b id="currentUser"></b></p>

    <label>Your USDT Wallet Address:</label>
    <input type="text" id="wallet" placeholder="Enter BEP20 USDT Wallet" />
    <button onclick="saveWallet()">Save Wallet</button>

    <h3>üí∏ Make a Deposit</h3>
    <p>Send USDT to:</p>
    <div class="highlight">0x49F7A836A32C1aCF04d4d20Fa87A14C7a19aB74B</div>
    <input type="number" id="depositAmount" placeholder="Amount in USDT (1 to 1000)" />
    <button onclick="makeDeposit()">Submit Deposit</button>

    <h3>üìä Your Deposits</h3>
    <div id="userDeposits"></div>

    <h3>üí∞ Referral Team</h3>
    <div id="refTeam"></div>

    <h3>üìà Your Referral Commission</h3>
    <div id="refEarnings"></div>

    <h3>üè¶ Expected Return (After 13 Months)</h3>
    <div id="returnAmount"></div>

    <button onclick="logout()">Logout</button>
  </div>

  <div id="adminLogin" class="hide">
    <h3>üîí Admin Login</h3>
    <input type="password" id="adminPass" placeholder="Enter Admin Password" />
    <button onclick="adminAccess()">Login as Admin</button>
  </div>

  <div id="adminPanel" class="admin-only">
    <h3>üëë Admin Panel</h3>
    <div id="allData"></div>
    <button onclick="logout()">Logout</button>
  </div>
</div>

<script>
let db = JSON.parse(localStorage.getItem("ashirwadDB") || "{}");
let currentUser = null;

function saveDB() {
  localStorage.setItem("ashirwadDB", JSON.stringify(db));
}

function login() {
  const uid = document.getElementById("uid").value.trim();
  const ref = document.getElementById("ref").value.trim();
  if (!uid) return alert("Enter valid User ID");
  if (!db[uid]) {
    db[uid] = { wallet: "", deposits: [], referral: ref || "", team: [], commission: 0 };
    if (ref && db[ref]) db[ref].team.push(uid);
  }
  currentUser = uid;
  document.getElementById("auth").classList.add("hide");
  document.getElementById("app").classList.remove("hide");
  document.getElementById("currentUser").innerText = uid;
  showData();
  saveDB();
}

function logout() {
  currentUser = null;
  document.getElementById("auth").classList.remove("hide");
  document.getElementById("app").classList.add("hide");
  document.getElementById("adminPanel").classList.add("admin-only");
  document.getElementById("adminLogin").classList.add("hide");
}

function saveWallet() {
  const w = document.getElementById("wallet").value.trim();
  if (!w.startsWith("0x") || w.length < 20) return alert("Invalid wallet");
  db[currentUser].wallet = w;
  alert("Wallet Saved");
  saveDB();
}

function makeDeposit() {
  const amt = parseFloat(document.getElementById("depositAmount").value);
  if (amt < 1 || amt > 1000) return alert("Amount must be between 1 and 1000 USDT");
  const time = new Date().toLocaleString();
  db[currentUser].deposits.push({ amt, time });

  // Referral commission
  const ref = db[currentUser].referral;
  if (ref && db[ref]) {
    const bonus = amt * 0.05;
    db[ref].commission += bonus;
  }

  alert("Deposit recorded");
  saveDB();
  showData();
}

function showData() {
  const u = db[currentUser];
  document.getElementById("wallet").value = u.wallet || "";
  document.getElementById("userDeposits").innerHTML = u.deposits.map(d => `<div>${d.amt} USDT on ${d.time}</div>`).join("");
  document.getElementById("refTeam").innerText = u.team.join(", ") || "No referrals yet";
  document.getElementById("refEarnings").innerText = `${u.commission?.toFixed(2) || 0} USDT`;
  const total = u.deposits.reduce((sum, d) => sum + d.amt, 0);
  document.getElementById("returnAmount").innerText = `${(total * 1.2).toFixed(2)} USDT`;
}

function adminAccess() {
  const pass = document.getElementById("adminPass").value;
  if (pass !== "admin123") return alert("Wrong password");
  let html = "";
  for (let [uid, data] of Object.entries(db)) {
    const total = data.deposits.reduce((sum, d) => sum + d.amt, 0);
    html += `<div style="border:1px solid #ccc;padding:10px;margin-top:10px">
      <b>User:</b> ${uid}<br/>
      <b>Wallet:</b> ${data.wallet || "N/A"}<br/>
      <b>Total Deposit:</b> ${total} USDT<br/>
      <b>Return:</b> ${(total * 1.2).toFixed(2)} USDT<br/>
      <b>Referral:</b> ${data.referral || "None"}<br/>
      <b>Commission:</b> ${data.commission.toFixed(2)} USDT<br/>
      <b>Team:</b> ${data.team.join(", ") || "None"}
    </div>`;
  }
  document.getElementById("adminPanel").classList.remove("admin-only");
  document.getElementById("adminLogin").classList.add("hide");
  document.getElementById("auth").classList.add("hide");
  document.getElementById("app").classList.add("hide");
  document.getElementById("allData").innerHTML = html;
}
</script>
</body>
</html>
