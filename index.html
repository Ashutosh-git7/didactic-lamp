<!DOCTYPE html>
<html>
<head>
  <title>Ashirwad Mart</title>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { font-family: sans-serif; background: #f9f9f9; margin: 0; padding: 0; }
    .container { max-width: 500px; margin: auto; padding: 20px; background: white; border-radius: 10px; margin-top: 20px; }
    input, button { width: 100%; padding: 10px; margin-top: 10px; border-radius: 5px; border: 1px solid #ccc; }
    h2 { text-align: center; color: #4CAF50; }
    .hidden { display: none; }
    .logout { color: red; margin-top: 20px; text-align: center; cursor: pointer; }
    .admin-card { background: #fff3cd; border: 1px solid #ffeeba; padding: 10px; border-radius: 5px; margin-top: 15px; }
    .btn { background: #4CAF50; color: white; border: none; }
  </style>
</head>
<body>
  <div class="container" id="main">
    <h2>Ashirwad Mart</h2>

    <div id="auth">
      <input id="loginMobile" placeholder="Enter Mobile Number or Admin" />
      <input id="loginPass" placeholder="Enter Password (only for admin)" type="password" />
      <button onclick="login()">Login</button>
      <hr>
      <input id="regName" placeholder="Full Name" />
      <input id="regMobile" placeholder="Mobile Number" />
      <input id="regWallet" placeholder="USDT BEP20 Wallet Address" />
      <button onclick="register()">Register</button>
    </div>

    <div id="userPanel" class="hidden">
      <h3>Welcome, <span id="userName"></span></h3>
      <p><b>Mobile:</b> <span id="userMobile"></span></p>
      <p><b>Wallet:</b> <span id="userWallet"></span></p>
      <p><b>Deposit:</b> $<span id="userDeposit">0</span></p>
      <p><b>Referral Bonus:</b> $<span id="userReferral">0</span></p>
      <p><b>Income:</b> $<span id="userIncome">0</span></p>
      <p><b>Withdrawable:</b> $<span id="userWithdraw">0</span></p>
      <p><b>Fixed Deposit Address:</b><br><code>0x49F7A836A32C1aCF04d4d20Fa87A14C7a19aB74B</code></p>
      <input id="newDeposit" placeholder="Enter deposit amount (50‚Äì500)" />
      <button class="btn" onclick="makeDeposit()">Submit Deposit</button>
      <button class="btn" onclick="requestWithdraw()">Request Withdrawal</button>
      <div class="logout" onclick="logout()">üö™ Logout</div>
    </div>

    <div id="adminPanel" class="hidden">
      <h3>üë®‚Äçüíº Admin Dashboard</h3>
      <div id="allUsers"></div>
      <div class="logout" onclick="logout()">üö™ Logout</div>
    </div>
  </div>

  <script>
    let users = JSON.parse(localStorage.getItem('users') || '{}');
    let currentUser = null;

    function save() {
      localStorage.setItem('users', JSON.stringify(users));
    }

    function register() {
      const name = document.getElementById('regName').value.trim();
      const mobile = document.getElementById('regMobile').value.trim();
      const wallet = document.getElementById('regWallet').value.trim();
      if (!name || !mobile || !wallet) return alert("All fields required");
      if (users[mobile]) return alert("Mobile already registered");
      if (Object.values(users).some(u => u.wallet === wallet)) return alert("Wallet already in use");
      const id = 'ANS' + Math.floor(1000 + Math.random() * 9000);
      users[mobile] = { id, name, mobile, wallet, deposit: 0, referral: 0, income: 0, withdraw: 0 };
      save();
      alert("Registered successfully. You can now login with your mobile number.");
    }

    function login() {
      const mobile = document.getElementById('loginMobile').value.trim();
      const pass = document.getElementById('loginPass').value.trim();

      if (mobile === 'Admin' && pass === 'Jaihanuman@7') {
        currentUser = 'Admin';
        document.getElementById('auth').classList.add('hidden');
        document.getElementById('adminPanel').classList.remove('hidden');
        loadAdmin();
      } else if (users[mobile]) {
        currentUser = mobile;
        document.getElementById('auth').classList.add('hidden');
        document.getElementById('userPanel').classList.remove('hidden');
        loadUser();
      } else {
        alert("Invalid login");
      }
    }

    function loadUser() {
      const u = users[currentUser];
      document.getElementById('userName').innerText = u.name;
      document.getElementById('userMobile').innerText = u.mobile;
      document.getElementById('userWallet').innerText = u.wallet;
      document.getElementById('userDeposit').innerText = u.deposit;
      document.getElementById('userReferral').innerText = u.referral;
      document.getElementById('userIncome').innerText = u.income;
      document.getElementById('userWithdraw').innerText = u.withdraw;
    }

    function logout() {
      currentUser = null;
      document.getElementById('auth').classList.remove('hidden');
      document.getElementById('userPanel').classList.add('hidden');
      document.getElementById('adminPanel').classList.add('hidden');
    }

    function makeDeposit() {
      const amount = parseFloat(document.getElementById('newDeposit').value);
      if (amount < 50 || amount > 500) return alert("Deposit must be between 50 and 500");
      if (users[currentUser].deposit > 0) return alert("Already deposited");
      users[currentUser].deposit = amount;
      const ref = prompt("Enter referral mobile (if any):");
      if (ref && users[ref]) users[ref].referral += amount * 0.05;
      save();
      alert("Deposit recorded. Await admin approval.");
      loadUser();
    }

    function requestWithdraw() {
      const u = users[currentUser];
      const total = u.income + u.referral;
      if (total < 1) return alert("Minimum $1 required to withdraw");
      u.withdraw = total;
      save(); loadUser();
      alert("Withdrawal request submitted");
    }

    function loadAdmin() {
      let out = '';
      for (let mob in users) {
        const u = users[mob];
        out += `<div class="admin-card">
          <b>ID:</b> ${u.id}<br>
          <b>Name:</b> ${u.name}<br>
          <b>Mobile:</b> ${u.mobile}<br>
          <b>Wallet:</b> ${u.wallet}<br>
          <b>Deposit:</b> $${u.deposit}<br>
          <b>Referral:</b> $${u.referral}<br>
          <b>Income:</b> $${u.income}<br>
          <b>Withdraw Request:</b> $${u.withdraw}<br>
          <button onclick="addIncome('${mob}')">+ Add Income</button>
          <button onclick="approveWithdraw('${mob}')">Approve Withdraw</button>
          <button onclick="editUser('${mob}')">Edit</button>
        </div>`;
      }
      document.getElementById('allUsers').innerHTML = out;
    }

    function addIncome(mobile) {
      const amt = prompt("Enter amount to add:");
      if (amt) {
        users[mobile].income += parseFloat(amt);
        save(); loadAdmin();
      }
    }

    function approveWithdraw(mobile) {
      users[mobile].withdraw = 0;
      users[mobile].income = 0;
      users[mobile].referral = 0;
      save(); loadAdmin();
      alert("Withdrawal approved");
    }

    function editUser(mobile) {
      const u = users[mobile];
      const dep = prompt("Deposit", u.deposit);
      const ref = prompt("Referral", u.referral);
      const inc = prompt("Income", u.income);
      users[mobile].deposit = parseFloat(dep);
      users[mobile].referral = parseFloat(ref);
      users[mobile].income = parseFloat(inc);
      save(); loadAdmin();
    }
  </script>
</body>
</html>
