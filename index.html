<!DOCTYPE html>
<html>
<head>
  <title>üöÄ Ashirwad Mart P - Founder Registration</title>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #121212 0%, #1a1a2e 50%, #16213e 100%);
      color: #e0e0e0;
      margin: 0;
      padding: 20px;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    h2 { color: #00ffe1; text-align: center; margin: 20px 0; font-size: 28px; }
    .box {
      background: rgba(30, 30, 30, 0.95);
      padding: 30px;
      margin: 20px 0;
      border-radius: 16px;
      box-shadow: 0 10px 40px rgba(0, 255, 225, 0.2);
      width: 100%;
      max-width: 500px;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(0, 255, 225, 0.1);
    }
    input, select, textarea {
      padding: 15px;
      margin: 12px 0;
      width: 100%;
      border-radius: 10px;
      border: 1px solid #333;
      font-size: 16px;
      background: rgba(42, 42, 42, 0.8);
      color: #fff;
      box-sizing: border-box;
      transition: all 0.3s ease;
    }
    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: #00ffe1;
      background: rgba(57, 57, 57, 0.9);
      box-shadow: 0 0 15px rgba(0, 255, 225, 0.3);
    }
    button {
      padding: 15px 25px;
      margin: 10px 5px;
      border-radius: 10px;
      border: none;
      font-size: 16px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
      width: 100%;
    }
    .btn-primary {
      background: linear-gradient(45deg, #00ffe1, #00c7aa);
      color: #000;
    }
    .btn-primary:hover { background: linear-gradient(45deg, #00c7aa, #00ffe1); transform: translateY(-2px); }
    .btn-success { background: linear-gradient(45deg, #28a745, #20c997); color: white; }
    .btn-success:hover { background: linear-gradient(45deg, #20c997, #28a745); }
    .btn-danger { background: linear-gradient(45deg, #dc3545, #c82333); color: white; }
    .btn-danger:hover { background: linear-gradient(45deg, #c82333, #dc3545); }
    .payment-info {
      background: rgba(40, 167, 69, 0.2);
      padding: 20px;
      border-radius: 12px;
      border-left: 4px solid #28a745;
      margin: 20px 0;
    }
    .code-display {
      background: linear-gradient(45deg, #00ffe1, #00c7aa);
      color: #000;
      font-size: 24px;
      font-weight: 700;
      padding: 20px;
      border-radius: 12px;
      text-align: center;
      margin: 20px 0;
      letter-spacing: 3px;
    }
    .status-pending { color: #ffc107; }
    .status-approved { color: #28a745; }
    .status-rejected { color: #dc3545; }
    .admin-login-box {
      background: rgba(220, 53, 69, 0.15);
      border: 2px solid #dc3545;
    }
    .hidden { display: none !important; }
    @media (max-width: 640px) {
      .box { padding: 20px 15px; margin: 10px 0; }
      h2 { font-size: 24px; }
    }
  </style>
</head>
<body>
  <h2>üöÄ Ashirwad Mart P - Founder Registration</h2>

  <!-- Founder Registration Form -->
  <div id="registerBox" class="box">
    <h3>üëë Founder Registration (‚Çπ150)</h3>
    <p><strong>Product:</strong> 3 Sanitary Pads + Founder Certificate</p>
    
    <div class="payment-info">
      <h4>üí∞ Payment Details</h4>
      <p><strong>UPI ID:</strong> <code>ashutoshkarmkar7-1@oksbi</code></p>
      <p><strong>Amount:</strong> <strong>‚Çπ150</strong></p>
      <p><em>Payment karne ke baad "Payment Reference" mein UPI Transaction ID daalein</em></p>
    </div>

    <input type="text" id="founderName" placeholder="Full Name *" required />
    <input type="tel" id="founderMobile" placeholder="Mobile Number *" required />
    <input type="email" id="founderEmail" placeholder="Email (optional)" />
    <input type="text" id="founderAddress" placeholder="Address *" required />
    <input type="text" id="paymentRef" placeholder="UPI Transaction ID / Reference *" required />
    <input type="text" id="paymentScreenshot" placeholder="Payment Screenshot URL (optional)" />
    
    <select id="productReceived">
      <option value="No">Product Received? No</option>
      <option value="Yes">Product Received? Yes</option>
    </select>
    
    <button class="btn-primary" onclick="registerFounder()">üìù Register Founder</button>
  </div>

  <!-- Admin Login -->
  <div id="adminLoginBox" class="box admin-login-box">
    <h3>üîê Admin Login</h3>
    <input type="password" id="adminPassword" placeholder="Admin Password" />
    <button class="btn-success" onclick="adminLogin()">Login to Admin Panel</button>
    <p style="text-align: center; margin-top: 15px;">
      <small><strong>Admin Code:</strong> Jaihanuman@7</small>
    </p>
  </div>

  <!-- Admin Panel -->
  <div id="adminPanel" class="box hidden" style="max-width: 900px;">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
      <h3>üõ†Ô∏è Admin - Founder Registrations</h3>
      <div>
        <button class="btn-success" onclick="refreshFounders()" style="width: auto; padding: 10px 20px; margin-right: 10px;">üîÑ Refresh</button>
        <button class="btn-danger" onclick="adminLogout()" style="width: auto; padding: 10px 20px;">üö™ Logout</button>
      </div>
    </div>
    
    <div id="foundersList"></div>
  </div>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyCBXuE2NHuZkKeQY7JjYM5vpbF1-K9AcS8",
    authDomain: "ashirwadmart-6d657.firebaseapp.com",
    databaseURL: "https://ashirwadmart-6d657-default-rtdb.firebaseio.com",
    projectId: "ashirwadmart-6d657",
    storageBucket: "ashirwadmart-6d657.appspot.com",
    messagingSenderId: "1013585797321",
    appId: "1:1013585797321:web:8a5c5fdb50c6aa7e7e57aa"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  let isAdminLoggedIn = false;

  function generateFounderCode() {
    const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
    let code = 'F';
    for (let i = 0; i < 7; i++) {
      code += chars.charAt(Math.floor(Math.random() * chars.length));
    }
    return code;
  }

  async function registerFounder() {
    const name = document.getElementById('founderName').value.trim();
    const mobile = document.getElementById('founderMobile').value.trim();
    const email = document.getElementById('founderEmail').value.trim();
    const address = document.getElementById('founderAddress').value.trim();
    const paymentRef = document.getElementById('paymentRef').value.trim();
    const screenshot = document.getElementById('paymentScreenshot').value.trim();
    const productReceived = document.getElementById('productReceived').value;

    if (!name || !mobile || !address || !paymentRef) {
      return alert('‚ùå ‡§∏‡§≠‡•Ä required fields ‡§≠‡§∞‡•á‡§Ç!');
    }

    if (mobile.length !== 10 || isNaN(mobile)) {
      return alert('‚ùå Valid 10-digit mobile number enter ‡§ï‡§∞‡•á‡§Ç!');
    }

    // Check if founder code already exists
    const founderCode = generateFounderCode();
    const codeCheck = await db.ref('founders').orderByChild('code').equalTo(founderCode).once('value');
    if (codeCheck.exists()) {
      return registerFounder();
    }

    const founderData = {
      name,
      mobile,
      email: email || '',
      address,
      paymentRef,
      screenshot,
      productReceived,
      code: founderCode,
      status: 'Pending',
      timestamp: new Date().toISOString(),
      paymentAmount: 150
    };

    db.ref('founders').push(founderData).then(() => {
      alert(`‚úÖ Founder Registered!

Your Unique Founder Code: ${founderCode}

‡§á‡§∏‡•á safe ‡§∞‡§ñ‡•á‡§Ç ‡§î‡§∞ share ‡§® ‡§ï‡§∞‡•á‡§Ç‡•§
Admin approval ‡§ï‡§æ wait ‡§ï‡§∞‡•á‡§Ç‡•§`);
      
      // Clear form
      document.getElementById('founderName').value = '';
      document.getElementById('founderMobile').value = '';
      document.getElementById('founderEmail').value = '';
      document.getElementById('founderAddress').value = '';
      document.getElementById('paymentRef').value = '';
      document.getElementById('paymentScreenshot').value = '';
      
      // Show founder code
      showFounderCode(founderCode);
    }).catch(err => {
      alert('‚ùå Registration failed: ' + err.message);
    });
  }

  function showFounderCode(code) {
    const box = document.getElementById('registerBox');
    const existingCode = box.querySelector('.code-display');
    if (existingCode) existingCode.remove();
    
    box.innerHTML += `
      <div class="code-display">üéâ ${code} üéâ</div>
      <p style="text-align: center; color: #00ffe1;">
        Founder Code generate ‡§π‡•ã ‡§ó‡§Ø‡§æ! Admin approval ‡§ï‡§æ wait ‡§ï‡§∞‡•á‡§Ç‡•§
      </p>
    `;
  }

  function adminLogin() {
    const password = document.getElementById('adminPassword').value;
    if (password === 'Jaihanuman@7') {
      isAdminLoggedIn = true;
      document.getElementById('adminLoginBox').classList.add('hidden');
      document.getElementById('adminPanel').classList.remove('hidden');
      loadFounders();
      alert('‚úÖ Admin Login Successful!');
    } else {
      alert('‚ùå Wrong Password!');
      document.getElementById('adminPassword').value = '';
    }
  }

  function adminLogout() {
    isAdminLoggedIn = false;
    document.getElementById('adminPanel').classList.add('hidden');
    document.getElementById('adminLoginBox').classList.remove('hidden');
    document.getElementById('adminPassword').value = '';
    document.getElementById('foundersList').innerHTML = '';
  }

  function loadFounders() {
    db.ref('founders').orderByChild('timestamp').limitToLast(100).on('value', snap => {
      let html = '<table style="width: 100%; border-collapse: collapse; margin-top: 20px;">';
      html += '<thead><tr style="background: linear-gradient(45deg, #00ffe1, #00c7aa); color: #000;">';
      html += '<th style="padding: 12px; text-align: center;">Founder Code</th>';
      html += '<th style="padding: 12px; text-align: center;">Name</th>';
      html += '<th style="padding: 12px; text-align: center;">Mobile</th>';
      html += '<th style="padding: 12px; text-align: center;">Payment Ref</th>';
      html += '<th style="padding: 12px; text-align: center;">Status</th>';
      html += '<th style="padding: 12px; text-align: center;">Date</th>';
      html += '<th style="padding: 12px; text-align: center;">Actions</th></tr></thead><tbody>';

      let totalPending = 0;
      let totalApproved = 0;
      let totalRejected = 0;

      snap.forEach(child => {
        const data = child.val();
        const key = child.key;
        const statusClass = data.status === 'Approved' ? 'status-approved' : 
                           data.status === 'Rejected' ? 'status-rejected' : 'status-pending';
        const date = data.timestamp ? new Date(data.timestamp).toLocaleString('en-IN') : '';
        
        if (data.status === 'Pending') totalPending++;
        if (data.status === 'Approved') totalApproved++;
        if (data.status === 'Rejected') totalRejected++;

        html += `<tr style="border-bottom: 1px solid #333;">`;
        html += `<td style="padding: 12px; font-weight: bold; color: #00ffe1;">${data.code}</td>`;
        html += `<td style="padding: 12px;">${data.name}</td>`;
        html += `<td style="padding: 12px;">${data.mobile}</td>`;
        html += `<td style="padding: 12px; font-size: 12px; max-width: 150px; word-break: break-all;">${data.paymentRef}</td>`;
        html += `<td style="padding: 12px;"><span class="${statusClass}">${data.status}</span></td>`;
        html += `<td style="padding: 12px; font-size: 12px;">${date}</td>`;
        html += `<td style="padding: 12px;">
                  <button class="btn-success" onclick="updateStatus('${key}', 'Approved')" style="padding: 5px 10px; margin: 2px; font-size: 12px;">‚úÖ Approve</button>
                  <button class="btn-danger" onclick="updateStatus('${key}', 'Rejected')" style="padding: 5px 10px; margin: 2px; font-size: 12px;">‚ùå Reject</button>
                 </td>`;
        html += `</tr>`;
      });

      html += '</tbody></table>';
      html += `<div style="margin-top: 20px; padding: 15px; background: rgba(0,255,225,0.1); border-radius: 10px;">`;
      html += `<strong>üìä Total: Pending-${totalPending} | Approved-${totalApproved} | Rejected-${totalRejected}</strong>`;
      html += `</div>`;

      document.getElementById('foundersList').innerHTML = html;
    });
  }

  function updateStatus(key, status) {
    if (confirm(`Are you sure? Status will be changed to "${status}"`)) {
      db.ref('founders/' + key).update({ status }).then(() => {
        alert('‚úÖ Status updated successfully!');
      }).catch(err => {
        alert('‚ùå Error: ' + err.message);
      });
    }
  }

  function refreshFounders() {
    loadFounders();
  }

  // Enter key support for admin login
  document.addEventListener('keypress', function(e) {
    if (e.key === 'Enter' && document.getElementById('adminPassword') === document.activeElement) {
      adminLogin();
    }
  });

  // Initialize
  document.getElementById('adminPassword').focus();
</script>
</body>
</html>
