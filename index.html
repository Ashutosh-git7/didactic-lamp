<!DOCTYPE html>
<html>
<head>
  <title>Ashirwad Mart App</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { font-family: Arial, sans-serif; background: #f2f2f2; margin: 0; padding: 15px; }
    .container { max-width: 500px; margin: auto; background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 0 8px #ccc; }
    input, button { width: 100%; padding: 10px; margin: 8px 0; border: 1px solid #ccc; border-radius: 5px; }
    button { background: #007bff; color: #fff; font-weight: bold; }
    button:hover { background: #0056b3; }
    .hidden { display: none; }
    .section { margin: 15px 0; padding: 10px; background: #f9f9f9; border-left: 4px solid #007bff; }
    .admin-card { background: #eef; padding: 10px; margin: 10px 0; border-radius: 5px; }
  </style>
</head>
<body>
  <div class="container">
    <h2>Ashirwad Mart App</h2>

    <!-- Auth Section -->
    <div id="auth">
      <h3>Register</h3>
      <input id="regId" placeholder="User ID (start with ASH)">
      <input id="regPass" type="password" placeholder="Password">
      <input id="regWallet" placeholder="Your BEP20 Wallet">
      <input id="regRef" placeholder="Referral ID (optional)">
      <button onclick="register()">Register</button>
      <hr>
      <h3>Login</h3>
      <input id="loginId" placeholder="User ID">
      <input id="loginPass" type="password" placeholder="Password">
      <button onclick="login()">Login</button>
    </div>

    <!-- User Dashboard -->
    <div id="userPanel" class="hidden">
      <h3>Welcome, <span id="userName"></span></h3>
      <div class="section">
        <b>Wallet:</b> <span id="walletInfo"></span><br>
        <b>Your ID:</b> <span id="uidDisplay"></span><br>
        <b>Referral Income:</b> $<span id="refIncome">0</span><br>
        <b>Total Deposit:</b> $<span id="depAmt">0</span><br>
        <b>Profit Earned:</b> $<span id="profitAmt">0</span><br>
        <b>Withdrawable:</b> $<span id="withdrawAmt">0</span>
      </div>
      <div class="section">
        <h4>Make Deposit</h4>
        <p>Send USDT to: <b>0x49F7A836A32C1aCF04d4d20Fa87A14C7a19aB74B</b></p>
        <input id="depInput" type="number" placeholder="Amount (50–500)">
        <button onclick="makeDeposit()">Submit Deposit</button>
      </div>
      <div class="section">
        <h4>Withdraw</h4>
        <button onclick="withdraw()">Withdraw Funds</button>
      </div>
      <button onclick="logout()">Logout</button>
    </div>

    <!-- Admin Panel -->
    <div id="adminPanel" class="hidden">
      <h3>Admin Dashboard</h3>
      <div id="adminUsers"></div>
      <button onclick="logout()">Logout</button>
    </div>
  </div>

  <script>
    let users = JSON.parse(localStorage.getItem("users") || "{}");
    let currentUser = null;

    function saveUsers() {
      localStorage.setItem("users", JSON.stringify(users));
    }

    function register() {
      const id = document.getElementById("regId").value.trim();
      const pass = document.getElementById("regPass").value.trim();
      const wallet = document.getElementById("regWallet").value.trim();
      const ref = document.getElementById("regRef").value.trim();

      if (!id.startsWith("ASH")) return alert("User ID must start with 'ASH'");
      if (users[id]) return alert("User already exists");
      if (!wallet) return alert("Wallet required");

      users[id] = {
        password: pass,
        wallet,
        ref,
        deposit: 0,
        profit: 0,
        withdrawable: 0,
        refBonus: 0
      };

      saveUsers();
      alert("Registered. Now login.");
    }

    function login() {
      const id = document.getElementById("loginId").value.trim();
      const pass = document.getElementById("loginPass").value.trim();

      if (id === "Admin" && pass === "Jaihanuman@7") return showAdmin();

      if (!users[id] || users[id].password !== pass) return alert("Invalid credentials");

      currentUser = id;
      showUserPanel();
    }

    function showUserPanel() {
      const u = users[currentUser];
      document.getElementById("auth").classList.add("hidden");
      document.getElementById("userPanel").classList.remove("hidden");
      document.getElementById("userName").innerText = currentUser;
      document.getElementById("walletInfo").innerText = u.wallet;
      document.getElementById("uidDisplay").innerText = currentUser;
      document.getElementById("refIncome").innerText = u.refBonus || 0;
      document.getElementById("depAmt").innerText = u.deposit || 0;
      document.getElementById("profitAmt").innerText = u.profit || 0;
      document.getElementById("withdrawAmt").innerText = u.withdrawable || 0;
    }

    function makeDeposit() {
      const amt = parseFloat(document.getElementById("depInput").value);
      if (amt < 50 || amt > 500) return alert("Amount must be between $50–$500");

      const u = users[currentUser];
      if (u.deposit > 0) return alert("You already deposited");

      u.deposit = amt;
      u.profit = 0;
      u.withdrawable = 0;

      if (u.ref && users[u.ref]) {
        const refAmt = amt * 0.05;
        users[u.ref].refBonus += refAmt;
        users[u.ref].withdrawable += refAmt;
      }

      saveUsers();
      alert("Deposit submitted. Wait for admin approval.");
      showUserPanel();
    }

    function withdraw() {
      const u = users[currentUser];
      if (u.withdrawable < 1) return alert("Minimum $1 required to withdraw.");
      alert(`Withdrawal of $${u.withdrawable} requested.`);
      u.withdrawable = 0;
      saveUsers();
      showUserPanel();
    }

    function logout() {
      currentUser = null;
      document.getElementById("auth").classList.remove("hidden");
      document.getElementById("userPanel").classList.add("hidden");
      document.getElementById("adminPanel").classList.add("hidden");
    }

    function showAdmin() {
      document.getElementById("auth").classList.add("hidden");
      document.getElementById("adminPanel").classList.remove("hidden");

      let html = "";
      Object.keys(users).forEach(id => {
        const u = users[id];
        html += `<div class="admin-card">
          <b>${id}</b><br>
          Wallet: ${u.wallet}<br>
          Deposit: $${u.deposit} | Profit: $${u.profit} | Withdrawable: $${u.withdrawable}<br>
          <button onclick="addProfit('${id}')">+10% Profit</button>
          <button onclick="close2x('${id}')">Close 2x</button>
          <button onclick="resetUser('${id}')">Reset</button>
        </div>`;
      });
      document.getElementById("adminUsers").innerHTML = html;
    }

    function addProfit(id) {
      const u = users[id];
      const inc = u.deposit * 0.1;
      if (u.profit + inc <= u.deposit * 2) {
        u.profit += inc;
        u.withdrawable += inc;
        alert("+10% profit added.");
      } else {
        alert("2x already reached.");
      }
      saveUsers();
      showAdmin();
    }

    function close2x(id) {
      const u = users[id];
      u.profit = u.deposit * 2;
      u.withdrawable = u.deposit * 2;
      alert("2x agreement closed.");
      saveUsers();
      showAdmin();
    }

    function resetUser(id) {
      users[id].deposit = 0;
      users[id].profit = 0;
      users[id].withdrawable = 0;
      alert("User reset done.");
      saveUsers();
      showAdmin();
    }
  </script>
</body>
</html>
