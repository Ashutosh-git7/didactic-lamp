<!DOCTYPE html>
<html>
<head>
  <title>Ashirwad 2X App</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: Arial; background: #f2f2f2; margin: 0; padding: 0; }
    header { background: #4CAF50; color: white; padding: 15px; text-align: center; }
    section, .card { background: white; margin: 15px; padding: 15px; border-radius: 10px; box-shadow: 0 0 5px rgba(0,0,0,0.1);}
    input, button { width: 100%; padding: 10px; margin: 8px 0; border: 1px solid #ccc; border-radius: 8px; box-sizing: border-box; }
    button { background-color: #4CAF50; color: white; font-weight: bold; border: none; }
    .hide { display: none; }
    textarea { width: 100%; height: 300px; }
    nav { background: #eee; text-align: center; padding: 10px; font-size: 14px; }
  </style>
</head>
<body>

<header>
  <h2>Ashirwad 2X Income App</h2>
</header>

<section id="loginSection">
  <h3>Register / Login</h3>
  <input id="userId" placeholder="User ID (e.g. ANS123)" />
  <input id="wallet" placeholder="Your BEP20 Wallet Address" />
  <input id="refCode" placeholder="Referral Code (optional)" />
  <button onclick="loginUser()">Login / Register</button>
  <p id="loginMsg"></p>
</section>

<section id="userPanel" class="hide">
  <h3>Welcome, <span id="currentUser"></span></h3>
  <div class="card">
    <p><b>Wallet:</b> <span id="userWallet"></span></p>
    <p><b>Total Deposit:</b> <span id="userDeposit">0</span> USDT</p>
    <p><b>Total Paid:</b> <span id="userPaid">0</span> USDT</p>
    <p><b>Referral Bonus:</b> <span id="userReferral">0</span> USDT</p>
    <p><b>Agreement:</b> <span id="userAgreement">open</span></p>
  </div>

  <div class="card">
    <h4>Deposit (50–500 USDT)</h4>
    <p>Send to: <b>0x49F7A836A32C1aCF04d4d20Fa87A14C7a19aB74B</b></p>
    <input id="depAmt" placeholder="Enter amount" />
    <button onclick="makeDeposit()">Submit Deposit</button>
  </div>

  <div class="card">
    <h4>Withdraw</h4>
    <button onclick="withdraw()">Withdraw Income/Referral</button>
  </div>

  <div class="card">
    <h4>Your Referral Link</h4>
    <input id="refLink" readonly />
  </div>
</section>

<section id="adminLoginSection">
  <h3>Admin Login</h3>
  <input id="adminId" placeholder="Admin ID" />
  <input id="adminPass" type="password" placeholder="Admin Password" />
  <button onclick="adminLogin()">Login</button>
</section>

<section id="adminPanel" class="hide">
  <h3>Admin Panel</h3>
  <textarea id="adminEditor"></textarea>
  <button onclick="saveAdmin()">Save Changes</button>
</section>

<nav>
  &copy; 2025 Ashirwad Mart
</nav>

<script>
let db = JSON.parse(localStorage.getItem("ashirwadDB") || "{}");
let currentUser = "";

function saveDB() {
  localStorage.setItem("ashirwadDB", JSON.stringify(db));
}

function loginUser() {
  const id = document.getElementById("userId").value.trim().toUpperCase();
  const wallet = document.getElementById("wallet").value.trim();
  const ref = document.getElementById("refCode").value.trim().toUpperCase();

  if (!id.startsWith("ANS")) {
    document.getElementById("loginMsg").innerText = "ID must start with ANS";
    return;
  }
  if (!db[id]) {
    if (!wallet.startsWith("0x") || wallet.length < 20) {
      document.getElementById("loginMsg").innerText = "Invalid wallet address";
      return;
    }
    db[id] = { wallet, deposit: 0, paid: 0, referral: 0, agreement: "open", ref: ref || "" };
    if (ref && db[ref]) {
      db[ref].referral += 5;
    }
  }
  currentUser = id;
  saveDB();
  showUserPanel();
}

function showUserPanel() {
  const u = db[currentUser];
  document.getElementById("loginSection").classList.add("hide");
  document.getElementById("userPanel").classList.remove("hide");
  document.getElementById("currentUser").innerText = currentUser;
  document.getElementById("userWallet").innerText = u.wallet;
  document.getElementById("userDeposit").innerText = u.deposit;
  document.getElementById("userPaid").innerText = u.paid;
  document.getElementById("userReferral").innerText = u.referral;
  document.getElementById("userAgreement").innerText = u.agreement;
  document.getElementById("refLink").value = location.href.split("?")[0] + "?r=" + currentUser.toLowerCase();
}

function makeDeposit() {
  const amt = parseFloat(document.getElementById("depAmt").value);
  if (amt < 50 || amt > 500) return alert("Deposit between 50–500 only.");
  db[currentUser].deposit += amt;
  saveDB();
  alert("Deposit recorded. Admin will verify.");
  showUserPanel();
}

function withdraw() {
  const user = db[currentUser];
  const total = user.referral + user.paid;
  if (total < 1) return alert("Minimum 1 USDT required.");
  alert("Withdraw request sent.");
  db[currentUser].referral = 0;
  saveDB();
  showUserPanel();
}

function adminLogin() {
  const id = document.getElementById("adminId").value;
  const pass = document.getElementById("adminPass").value;
  if (id === "Admin" && pass === "Jaihanuman@7") {
    document.getElementById("adminPanel").classList.remove("hide");
    document.getElementById("adminEditor").value = JSON.stringify(db, null, 2);
  } else {
    alert("Invalid admin login.");
  }
}

function saveAdmin() {
  try {
    db = JSON.parse(document.getElementById("adminEditor").value);
    saveDB();
    alert("Saved successfully.");
  } catch {
    alert("Invalid data format.");
  }
}

window.onload = () => {
  const url = new URLSearchParams(window.location.search);
  const r = url.get("r");
  if (r) document.getElementById("refCode").value = r;
};
</script>

</body>
</html>
